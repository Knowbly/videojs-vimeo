/**
 * videojs-vimeo
 * @version 2.0.2
 * @copyright 2018 Benoit Tremblay <trembl.ben@gmail.com>
 * @license MIT
 */
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function injectCss(){if(!cssInjected){cssInjected=!0;var e="\n    .vjs-vimeo iframe {\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n    }\n  ",t=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e)),t.appendChild(o)}}exports.__esModule=!0;var _video=require("video.js"),_video2=_interopRequireDefault(_video),_player=require("@vimeo/player"),_player2=_interopRequireDefault(_player),Component=_video2.default.getComponent("Component"),Tech=_video2.default.getComponent("Tech"),cssInjected=!1,Vimeo=function(e){function t(o,i){_classCallCheck(this,t);var n=_possibleConstructorReturn(this,e.call(this,o,i));return injectCss(),n.setPoster(o.poster),n.setTimeout(function(){this.el_&&(this.el_.parentNode.className+=" vjs-vimeo",this.initVimeoPlayer())}.bind(n)),n}return _inherits(t,e),t.prototype.initVimeoPlayer=function(){var e=this,t={url:this.options_.source.src,byline:!1,portrait:!1,title:!1};this.options_.autoplay&&(t.autoplay=!0),this.options_.height&&(t.height=this.options_.height),this.options_.width&&(t.width=this.options_.width),this.options_.maxheight&&(t.maxheight=this.options_.maxheight),this.options_.maxwidth&&(t.maxwidth=this.options_.maxwidth),this.options_.loop&&(t.loop=this.options_.loop),this.options_.color&&(t.color=this.options_.color.replace(/^#/,"")),this._player=new _player2.default(this.el(),t),this.initVimeoState(),["play","pause","ended","timeupdate","progress","seeked"].forEach(function(t){e._player.on(t,function(o){e._vimeoState.progress.duration!==o.duration&&e.trigger("durationchange"),e._vimeoState.progress=o,e.trigger(t)})}),this._player.on("pause",function(){return e._vimeoState.playing=!1}),this._player.on("play",function(){e._vimeoState.playing=!0,e._vimeoState.ended=!1}),this._player.on("ended",function(){e._vimeoState.playing=!1,e._vimeoState.ended=!0}),this._player.on("volumechange",this.onPlayerVolumeChange.bind(this)),this._player.on("error",function(t){return e.trigger("error",t)}),this.triggerReady()},t.prototype.initVimeoState=function(){var e=this._vimeoState={ended:!1,playing:!1,volume:0,progress:{seconds:0,percent:0,duration:0}};this._player.getCurrentTime().then(function(t){return e.progress.seconds=t}),this._player.getDuration().then(function(t){return e.progress.duration=t}),this._player.getPaused().then(function(t){return e.playing=!t}),this._player.getVolume().then(function(t){return e.volume=t})},t.prototype.createEl=function(){var e=_video2.default.createEl("div",{id:this.options_.techId});return e.style.cssText="width:100%;height:100%;top:0;left:0;position:absolute",e.className="vjs-vimeo",e},t.prototype.controls=function(){return!1},t.prototype.supportsFullScreen=function(){return!0},t.prototype.src=function(){return this.options_.source},t.prototype.currentSrc=function(){return this.options_.source.src},t.prototype.currentTime=function(){return this._vimeoState.progress.seconds},t.prototype.setCurrentTime=function(e){this._player.setCurrentTime(e)},t.prototype.onPlayerVolumeChange=function(){this.trigger("volumechange")},t.prototype.volume=function(){return this._vimeoState.volume},t.prototype.setVolume=function(e){this._vimeoState.volume=e,this._player.setVolume(e)},t.prototype.duration=function(){return this._vimeoState.progress.duration},t.prototype.buffered=function(){var e=this._vimeoState.progress;return _video2.default.createTimeRange(0,e.percent*e.duration)},t.prototype.paused=function(){return!this._vimeoState.playing},t.prototype.pause=function(){this._player.pause()},t.prototype.play=function(){this._player.play()},t.prototype.muted=function(){return 0===this._vimeoState.volume},t.prototype.ended=function(){return this._vimeoState.ended},t.prototype.setMuted=function(e){this._player&&(e?(this._vimeoState.beforeMuteVolume=this._vimeoState.volume,this.setVolume(0)):this.setVolume(this._vimeoState.beforeMuteVolume),this.setTimeout(function(){this.trigger("volumechange")},50))},t}(Tech);Vimeo.prototype.featuresTimeupdateEvents=!0,Vimeo.isSupported=function(){return!0},Tech.withSourceHandlers(Vimeo),Vimeo.nativeSourceHandler={},Vimeo.nativeSourceHandler.canPlayType=function(e){return"video/vimeo"===e?"maybe":""},Vimeo.nativeSourceHandler.canHandleSource=function(e){return e.type?Vimeo.nativeSourceHandler.canPlayType(e.type):e.src?Vimeo.nativeSourceHandler.canPlayType(e.src):""},Vimeo.nativeSourceHandler.handleSource=function(e,t){t.src(e.src)},Vimeo.nativeSourceHandler.dispose=function(){},Vimeo.registerSourceHandler(Vimeo.nativeSourceHandler),Component.registerComponent("Vimeo",Vimeo),Tech.registerTech("Vimeo",Vimeo),Vimeo.VERSION="0.0.1",exports.default=Vimeo;
